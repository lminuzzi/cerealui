<form [formGroup]="formPedido" (ngSubmit)="onSubmit()">
<mat-accordion class="example-headers-align">
  <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Dados Gerais
      </mat-panel-title>
      <mat-panel-description>
        Informações gerais do pedido
        <mat-icon>info</mat-icon>
      </mat-panel-description>
    </mat-expansion-panel-header>
    <div>
      <mat-form-field>
        <mat-select placeholder="Produto" name="produto" id="produto" formControlName="produto">
          <mat-option value="SOJA">SOJA</mat-option>
          <!--
          <mat-option value="MILHO">MILHO</mat-option>
          <mat-option value="SORGO">SORGO</mat-option>
          <mat-option value="FEIJÃO">FEIJÃO</mat-option>
          <mat-option value="ARROZ">ARROZ</mat-option>
          <mat-option value="MILHETO">MILHETO</mat-option>
          -->
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <input matInput type="number" min="1" name="qtSacos" id="qtSacos" formControlName="qtSacos" placeholder="Quantidade (kg)">
      </mat-form-field>
      <mat-form-field>
        <input matInput type="number" min="1" name="valorLiq" id="valorLiq" formControlName="valorLiq" placeholder="Preço do Produtor">
      </mat-form-field>
      <mat-form-field>
        <input matInput type="number" min="1" name="valorVenda" id="valorVenda" formControlName="valorVenda" placeholder="Preço de Venda">
      </mat-form-field>
    </div>
    <div formGroupName="pedidoDadoBancario">
      <mat-form-field>
        <input matInput type="text" name="titularBanco" formControlName="titularBanco" id="titularBanco" placeholder="Titular">
      </mat-form-field>
      <mat-form-field>
        <input matInput type="text" name="cpfBanco" formControlName="cpfBanco" id="cpfBanco" placeholder="CPF">
      </mat-form-field>
      <mat-form-field>
        <input matInput type="text" name="agenciaBanco" formControlName="agenciaBanco" id="agenciaBanco" placeholder="Agência">
      </mat-form-field>
      <mat-form-field>
        <input matInput type="text" name="contaBanco" formControlName="contaBanco" id="contaBanco" placeholder="Conta">
      </mat-form-field>
      <mat-form-field>
        <input matInput type="text" name="nomeBanco" formControlName="nomeBanco" id="nomeBanco" placeholder="Nome do Banco">
      </mat-form-field>
    </div>
    <mat-action-row>
      <button mat-button type="button" color="primary" (click)="nextStep()">Próximo</button>
    </mat-action-row>
  </mat-expansion-panel>

  <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Compra e Venda
      </mat-panel-title>
      <mat-panel-description>
        Informações do Comprador e Vendedor
        <mat-icon>ballot</mat-icon>
      </mat-panel-description>
    </mat-expansion-panel-header>
    <div>
    <!-- <mat-grid-list cols="2">
      <mat-grid-tile> -->
      <div style="float: left;" formGroupName="compra">
        <!--<mat-card>
          <mat-card-header>
            <mat-card-title>Compra</mat-card-title>
            <mat-card-subtitle>Informações do Comprador</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>-->
            <app-fornecedor></app-fornecedor>
          <!--</mat-card-content>
        </mat-card>
        <mat-card>
          <mat-card-header>
            <mat-card-title>Compra</mat-card-title>
            <mat-card-subtitle>Informações de Compra</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>-->
            <div>
              <mat-form-field>
                <mat-select placeholder="Estado Saída" name="produtorEstado" id="produtorEstado" formControlName="produtorEstado">
                  <mat-option value="DF">DF</mat-option>
                  <mat-option value="GO">GO</mat-option>
                  <mat-option value="MG">MG</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <div>
              <mat-form-field>
                <mat-select placeholder="Filial Compra" name="filialCompra" id="filialCompra" formControlName="filialCompra">
                  <mat-option value="GO">GO</mat-option>
                  <mat-option value="MG">MG</mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field>
                <mat-select placeholder="Atividade Compra" name="tipoAtividadeCompra" id="tipoAtividadeCompra" formControlName="tipoAtividadeCompra">
                  <mat-option value="PROD">PRODUTOR</mat-option>
                  <mat-option value="COOPERATIVA">COOPERATIVA</mat-option>
                  <mat-option value="CEREALISTA">CEREALISTA</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <div>
              <span>
                <label>Frete: </label>
                <mat-radio-group formControlName="compraPossuiFrete">
                  <mat-radio-button value="false" name="compraPossuiFrete" id="compraPossuiFrete_N">
                    Não&nbsp;&nbsp;&nbsp;
                  </mat-radio-button>
                  <mat-radio-button value="true" name="compraPossuiFrete" id="compraPossuiFrete_S">
                    Sim&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  </mat-radio-button>
                </mat-radio-group>
              </span>
            </div>
            <div>
              <div>
                <span>
                  <label>Tipo Frete: </label>
                  <mat-radio-group formControlName="compraTipoFrete">
                    <mat-radio-button value="PESSOA_FISICA" name="compraTipoFrete" id="compraTipoFrete_PF">
                      PF&nbsp;
                    </mat-radio-button>
                    <mat-radio-button value="PESSOA_JURIDICA" name="compraTipoFrete" id="compraTipoFrete_PJ">
                      PJ&nbsp;&nbsp;&nbsp;&nbsp;
                    </mat-radio-button>
                  </mat-radio-group>
                </span>
                <mat-form-field>
                  <input matInput type="number" min="1" name="compraFrete" id="compraFrete" placeholder="Valor do Frete/Ton" formControlName="compraFrete">
                </mat-form-field>
              </div>
            </div>
            <div>
              <span>
                <label>Corr.: </label>
                <mat-radio-group formControlName="compraPossuiCorretor">
                  <mat-radio-button value="false" name="compraPossuiCorretor" id="compraPossuiCorretor_N">
                    Não&nbsp;&nbsp;&nbsp;
                  </mat-radio-button>
                  <mat-radio-button value="true" name="compraPossuiCorretor" id="compraPossuiCorretor_S">
                    Sim&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  </mat-radio-button>
                </mat-radio-group>
              </span>
              <mat-form-field>
                <input matInput type="number" min="1" name="compraCorret" id="compraCorret" placeholder="Valor Comissão" formControlName="compraCorret">
              </mat-form-field>
            </div>
            <div>
              <mat-form-field>
                <mat-select placeholder="Empresa" name="empresa" id="empresa" formControlName="empresa">
                  <mat-option *ngFor="let empr of empresas;" value="{{empr}}">{{empr}}</mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field>
                <mat-select placeholder="Safra" name="safra" id="safra" formControlName="safra">
                  <mat-option value="{{ safraValorInicial }}">{{ safraValorInicial }}</mat-option>
                  <mat-option value="{{ safraValorFinal }}">{{ safraValorFinal }}</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <div>
              <span>
                <label>Pró-Rural: </label>
                <mat-radio-group formControlName="possuiProRural">
                  <mat-radio-button value="false" name="possuiProRural" id="possuiProRural_N">
                    Não&nbsp;
                  </mat-radio-button>
                  <mat-radio-button value="true" name="possuiProRural" id="possuiProRural_S" >
                    Sim&nbsp;&nbsp;&nbsp;&nbsp;
                  </mat-radio-button>
                </mat-radio-group>
              </span>
              <span>
                <label>FunRural: </label>
                <mat-radio-group formControlName="funrural">
                  <mat-radio-button value="false" name="funrural" id="funrural_N">
                    Não&nbsp;
                  </mat-radio-button>
                  <mat-radio-button value="true" name="funrural" id="funrural_S" >
                    Sim&nbsp;&nbsp;&nbsp;&nbsp;
                  </mat-radio-button>
                </mat-radio-group>
              </span>
            </div>
            <div>
              <mat-form-field>
                <input matInput type="text" name="periodoEntrega" id="periodoEntrega" placeholder="Período Entrega" formControlName="periodoEntrega">
              </mat-form-field>
              <mat-form-field>
                <input matInput type="text" name="localEmbarque" id="localEmbarque" placeholder="Local Embarque" formControlName="localEmbarque">
              </mat-form-field>
            </div>
            <div>
              <mat-form-field>
                  <input matInput placeholder="Data de Pagamento" name="compraDataPagamento" id="compraDataPagamento" readonly
                    [matDatepicker]="compraDataPagamento" (focus)="compraDataPagamento.open()" formControlName="compraDataPagamento">
                </mat-form-field>
                <mat-datepicker #compraDataPagamento></mat-datepicker>
              <mat-form-field>
                <textarea matInput placeholder="Observação" name="obsMod" id="obsMod" formControlName="obsMod"></textarea>
              </mat-form-field>
            </div>
          <!--</mat-card-content>
        </mat-card>-->
      </div>
      <!-- </mat-grid-tile>
      <mat-grid-tile> -->
        <div style="float: right;"><mat-divider [vertical]="true"></mat-divider></div>
        <div style="float: right;" formGroupName="venda">
          <!--<mat-card>
              <mat-card-header>
                <mat-card-title>Vendedor</mat-card-title>
                <mat-card-subtitle>Informações do Vendedor</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>-->
                <app-cliente></app-cliente>
              <!--</mat-card-content>
          </mat-card>
          <mat-card>
            <mat-card-header>
              <mat-card-title>Venda</mat-card-title>
              <mat-card-subtitle>Informações de Venda</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>-->
              <div>
                <mat-form-field>
                  <mat-select placeholder="Estado Cliente" name="estadoCliente" id="estadoCliente" formControlName="estadoCliente">
                    <mat-option value="GO">GO</mat-option>
                    <mat-option value="MG">MG</mat-option>
                    <mat-option value="PR">PR</mat-option>
                    <mat-option value="RS">RS</mat-option>
                    <mat-option value="RJ">RJ</mat-option>
                    <mat-option value="SC">SC</mat-option>
                    <mat-option value="SP">SP</mat-option>
                    <mat-option value="OUTROSESTADOS">OUTROS ESTADOS</mat-option>
                    <mat-option value="EXPORTACAO">EXPORTAÇÃO</mat-option>
                  </mat-select>
                </mat-form-field>
                <mat-form-field>
                  <mat-select placeholder="Atividade Venda" name="tipoAtividadeVenda" id="tipoAtividadeVenda" formControlName="tipoAtividadeVenda">
                    <mat-option value="PROD">PRODUTOR</mat-option>
                    <mat-option value="RACOES">RAÇÕES</mat-option>
                    <mat-option value="GRANJA">GRANJA</mat-option>
                    <mat-option value="HUMANO">HUMANO</mat-option>
                    <mat-option value="OUTROS">OUTROS</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div>
                  <span>
                    <label>Frete: </label>
                    <mat-radio-group formControlName="vendaPossuiFrete">
                      <mat-radio-button value="false" name="vendaPossuiFrete" id="vendaPossuiFrete_N">
                        Não&nbsp;&nbsp;&nbsp;
                      </mat-radio-button>
                      <mat-radio-button value="true" name="vendaPossuiFrete" id="vendaPossuiFrete_S">
                        Sim&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                      </mat-radio-button>
                    </mat-radio-group>
                  </span>
                </div>
                <div>
                  <span>
                    <label>Tipo Frete: </label>
                    <mat-radio-group formControlName="vendaTipoFrete">
                      <mat-radio-button value="PESSOA_FISICA" name="vendaTipoFrete" id="vendaTipoFrete_PF">
                        PF&nbsp;
                      </mat-radio-button>
                      <mat-radio-button value="PESSOA_JURIDICA" name="vendaTipoFrete" id="vendaTipoFrete_PJ">
                        PJ&nbsp;&nbsp;&nbsp;&nbsp;
                      </mat-radio-button>
                    </mat-radio-group>
                  </span>
                  <mat-form-field>
                    <input matInput type="number" min="1" name="vendaFrete" id="vendaFrete" placeholder="Valor do Frete/Ton" formControlName="vendaFrete">
                  </mat-form-field>
                </div>
                <div>
                  <span>
                    <label>Corr.: </label>
                    <mat-radio-group formControlName="vendaPossuiCorretor">
                      <mat-radio-button value="false" name="vendaPossuiCorretor" id="vendaPossuiCorretor_N">
                        Não&nbsp;&nbsp;&nbsp;
                      </mat-radio-button>
                      <mat-radio-button value="true" name="vendaPossuiCorretor" id="vendaPossuiCorretor_S" >
                        Sim&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                      </mat-radio-button>
                    </mat-radio-group>
                  </span>
                  <mat-form-field>
                    <input matInput type="number" min="1" name="vendaCorret" id="vendaCorret" placeholder="Valor Comissão" formControlName="vendaCorret">
                  </mat-form-field>
                </div>
                <div>
                  <mat-form-field>
                    <mat-select placeholder="Destino Grão" name="destGrao" id="destGrao" formControlName="destGrao">
                      <mat-option value="ESTOQUE">ESTOQUE</mat-option>
                      <mat-option value="EXPORTACAO">EXPORTAÇÃO</mat-option>
                      <mat-option value="MERCADO INTERNO">MERCADO INTERNO</mat-option>
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field>
                    <mat-select placeholder="Tipo de Venda" name="tpPedido" id="tpPedido" formControlName="tpPedido">
                      <mat-option value="COMERCIAL">COMERCIAL</mat-option>
                      <mat-option value="ESTOQUE">ESTOQUE</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div>
                  <mat-form-field>
                    <input matInput placeholder="Data de Pagamento" name="vendaDataPagamento" id="vendaDataPagamento" readonly
                      formControlName="vendaDataPagamento" [matDatepicker]="vendaDataPagamento" (focus)="vendaDataPagamento.open()">
                  </mat-form-field>
                  <mat-datepicker #vendaDataPagamento></mat-datepicker>
                  <mat-form-field>
                    <mat-select placeholder="Local Destino" name="tradingEstado" id="tradingEstado" formControlName="tradingEstado">
                      <mat-option *ngFor="let localDest of locaisDestino;" value="{{localDest}}">{{localDest}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
            <!--</mat-card-content>
          </mat-card>-->
        </div>
        <div style="clear: both;">&nbsp;</div>
      <!-- </mat-grid-tile>
    </mat-grid-list> -->

    <mat-action-row>
      <button mat-button type="button" color="warn" (click)="prevStep()">Anterior</button>
      <button mat-button type="button" color="primary" (click)="nextStep()">Próximo</button>
    </mat-action-row>
    </div>
  </mat-expansion-panel>

  <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Análise
      </mat-panel-title>
      <mat-panel-description>
        Informações para análise do pedido
        <mat-icon>equalizer</mat-icon>
      </mat-panel-description>
    </mat-expansion-panel-header>
    <div style="text-align: center">
        <button type="button" mat-raised-button color="primary" (click)="analisarPedido()">Analisar</button>
    </div><br/>
    <div>
      <div style="float: left;">
        <h2>Compra</h2><br/>
        Valor Líquido: {{ pedido.valorLiq }}<br/>
        ICMS: {{ pedido.compra.valorIcmsProdutor }}<br/>
        Funrural: {{ pedido.compra.valorFunRural }}<br/>
        Senar: {{ pedido.compra.valorSenar }}<br/>
        PAT: {{ pedido.compra.valorPat }}<br/>
        Valor Bruto: {{ pedido.compra.valorBrutoCompra }}<br/>
        Frete: {{ pedido.compra.compraFreteTotal }}<br/>
        Imposto sob Frete: <br/>
        Corretagem: {{ pedido.compra.compraCorretTotal }}<br/>
        Custo da Compra: {{ pedido.compra.compraCustoTotal }}<br/>
      </div>
      <div style="float: left; padding-left: 20%;">
        <h2>Venda</h2><br/>
        Custo da Compra: {{ pedido.compra.compraCustoTotal }}<br/>
        Frete: {{ pedido.venda.vendaFreteTotal }}<br/>
        Imposto sob Frete: <br/>
        Corretagem: {{ pedido.venda.vendaCorretTotal }}<br/>
        ICMS: {{ pedido.venda.vendaValorIcms }}<br/>
        PIS e COFINS: {{ pedido.venda.vendaValorPisECofins }}<br/>
        Valor Final com Impostos: {{ pedido.venda.vendaCustoTotal }}<br/>
      </div>
      <div style="float: right;">
        <h2>Margem</h2><br/>
        Preço de Venda (à Vista): <br/>
        Custo Total: {{ pedido.venda.vendaCustoTotal }}<br/>
        Margem Total: {{ pedido.margemTotal }}<br/>
        %Margem: {{ pedido.margem }}<br/>
      </div>
      <div style="clear: both;">&nbsp;</div>
    </div>
    <mat-action-row>
      <button mat-button type="button" color="warn" (click)="prevStep()">Anterior</button>
      <button mat-button type="button" color="primary" (click)="nextStep()">Fim</button>
    </mat-action-row>
  </mat-expansion-panel>

</mat-accordion>

<!--
<div class="example-container">
  <mat-form-field>
    <input matInput placeholder="Input">
  </mat-form-field>

  <mat-form-field>
    <textarea matInput placeholder="Textarea"></textarea>
  </mat-form-field>

  <mat-form-field>
    <mat-select placeholder="Select">
      <mat-option value="option">Option</mat-option>
    </mat-select>
  </mat-form-field>
</div>

<div class="example-container">
  <mat-form-field>
    <input matInput placeholder="Enter your email" [formControl]="email" required>
    <mat-error *ngIf="email.invalid">{{getErrorMessage()}}</mat-error>
  </mat-form-field>
</div>
<div class="example-container">
  <mat-form-field hintLabel="Max 10 characters">
    <input matInput #input maxlength="10" placeholder="Enter some input">
    <mat-hint align="end">{{input.value?.length || 0}}/10</mat-hint>
  </mat-form-field>

  <mat-form-field>
    <mat-select placeholder="Select me">
      <mat-option value="option">Option</mat-option>
    </mat-select>
    <mat-hint align="end">Here's the dropdown arrow ^</mat-hint>
  </mat-form-field>

  <mat-form-field>
    <input matInput placeholder="First name">
  </mat-form-field>

  <mat-form-field>
    <input matInput type="number" min="1" placeholder="Age">
  </mat-form-field>
</div>
-->
<br/>
<button type="submit" mat-raised-button color="primary">Salvar</button>
</form>
